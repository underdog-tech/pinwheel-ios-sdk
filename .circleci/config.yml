# For a detailed guide to building and testing on iOS, read the docs:
# https://circleci.com/docs/2.0/testing-ios/

version: 2.1

jobs:
  test_build:
    # working_directory: ~/pinwheel-ios-sdk/Example

    macos:
      xcode: 14.2.0

    steps:
      - checkout
      - run:
          name: 'Install aws-cli'
          command: ./scripts/install-aws-mac.sh
      - run: bundle install # Install gems
      - run:
          name: Update Internal SDK and tag with Alpha
          command: ./scripts/update-sdk.sh --latest --alpha
      - run:
          name: Configure git
          command: |
            git config user.email "pinwheel-it@pinwheelapi.com"
            git config user.name "pinwheel-it-svc"
      - run:
          name: 'Git tag version'
          command: ./scripts/git-tag.sh

workflows:
  branch-workflow:
    jobs:
      - test_build:
          context: 'production'
          filters:
            branches:
              ignore: master
  #master-workflow:
    #jobs:
      #- build_and_publish:
          #context: 'frontend-production'
          #filters:
            #branches:
              #only: master
