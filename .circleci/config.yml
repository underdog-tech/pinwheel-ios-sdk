version: 2.1

jobs:
  build_and_tag:
    macos:
      xcode: 15.0.0
    steps:
      - checkout
      - run:
          name: Install AWS CLI
          command: ./scripts/install-aws-mac.sh
      - run:
          name: Update SDK
          command: ./scripts/update-sdk.sh --latest
      - run:
          name: 'Git tag version'
          command: ./scripts/git-tag.sh
      - run:
          name: Cocoapods upload
          command: ./scripts/cocoapods-upload.sh
      - run:
          name: Create PR (master only)
          command: ./scripts/create-pr.sh

workflows:
  branch-workflow:
    jobs:
      - build_and_tag:
          context: 'frontend-production'
